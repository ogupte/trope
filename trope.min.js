(function(q,r){var h,n,s=!1;"undefined"!==typeof window?(s=!0,h={exports:{}},n=h.exports):"undefined"!==typeof module&&module.exports&&(h=module,n=module.exports);if(n=r(h,n))h.exports=n;s&&(window[q]=h.exports);return n})("Trope",function(q,r){function h(d,f){if(d===f)return f;var c=Object.keys(d),l,k;for(l=0;l<c.length;l+=1)k=c[l],f[k]=d[k];return f}function n(d,f){var c=Object.getPrototypeOf(d);d&&c&&(f(c),n(c,f))}function s(d,f){var c=[d],l;n(d,function(d){c.push(d)});for(l=c.length-1;0<=l;l--)f(c[l])}
function B(d,f){Object.keys(d).forEach(function(c){"function"===typeof d[c]&&f(d[c],c)})}function v(d,f,c){return Object.defineProperty(d,f,{value:c,configurable:!0,enumerable:!1,writable:!0})}function w(d,f,c){var l;for(l=0;l<f.length;l++)d[f[l]]=c}var u=function(){function d(a){if(typeof a===k){if(a.trope&&a.trope instanceof d)return a.trope;a={constructor:a}}a=a||{prototype:Object.create(null),useSuper:!1};var b=this;b.def=a;b.proto=a.prototype?a.prototype:null===a.prototype?Object.create(null):
Object.hasOwnProperty.call(a.constructor,q)?a.constructor.prototype:Object.create(null);b.constr=a.hasOwnProperty(t)?a.constructor:b.proto.hasOwnProperty&&b.proto.hasOwnProperty(t)?b.proto.constructor:b.proto instanceof Object?r:u;b.inherits=a.inherits?a.inherits instanceof d?a.inherits:a.inherits.trope?a.inherits.trope:typeof a.inherits===k?new d({constructor:a.inherits,prototype:a.inherits.prototype,useSuper:!1}):new d({prototype:a.inherits,useSuper:!1}):null;b.typeName=a.type?a.type:b.constr!==
Object&&b.constr.name?b.constr.name:b.inherits?b.inherits.typeName+"\u2093":"Object\u2093";b.instanceName=a.instance||b.typeName+"\u1d62";if(void 0===a.useInstanceName||a.useInstanceName)b.instanceContructor=eval("(function "+b.instanceName+" () {})"),b.instanceContructor.trope=b;var e;b.inherits&&b.inherits.useSuper?(void 0===a.useSuper||a.useSuper||console.warn("useSuper {"+b.typeName+"} must be same as parent {"+b.inherits.typeName+"} (defaults to true)!"),e=b.inherits.useSuper):e=void 0!==a.useSuper?
a.useSuper:!0;b.useSuper=e;b.isPrivate=void 0!==a.privacy?a.privacy:b.inherits?b.inherits.isPrivate:!1;b.superConstr=b.getSuperConstructor();b.autoInitializeConfigs=[];b.forEachTropeInChain(function(a){var e=a.def.autoinit;e&&a!==b&&(Array.isArray(e)?b.autoInitializeConfigs.push({mode:x,trope:a,args:e}):typeof e===k?b.autoInitializeConfigs.push({mode:y,trope:a,initFunc:e}):b.autoInitializeConfigs.push({mode:z,trope:a}))});b.finalProto=b.getPrototype();b.constr!==Object&&v(b.finalProto,t,b.constr)}
function f(a){return(new d(a)).getConstructor()}function c(){var a=arguments,a=(p[a.length]||p["?"]).apply(p,a);return f(a)}var l=this,k="function",q="prototype",t="constructor",r=function(){},u=function(){},z=1296124227,y=1296124233,x=1296124225,A=function(a){var b=a.length,e,d;for(e=0;e<b;e++)d=a[e],a.push(d.charAt(0).toUpperCase()+d.substr(1));return a}("class proto alter alt turn extend ext modify mod link chain draft denote outline cast exhibit model compound enhance".split(" "));d.prototype=
{getConstructor:function(a){var b=this;return function(a){a.prototype=b.finalProto;a.trope=b;a.create=function(){var b=Object.create(a.prototype);a.apply(b,arguments);return b};w(a,A,b.extend.bind(b));return a}(b.createProxyConstructor(a))},createProxyConstructor:function(a){var b=this;return function(){function e(){if(a)return f[1];h||(h=Object.create(g),h.exports=g);return h}var c=arguments,f=arguments,g=this,h,n=g;g===l&&(n=g=Object.create(b.finalProto));b.isPrivate&&(n=e());var m;b.useSuper&&
!a&&g.hasOwnProperty&&!g.hasOwnProperty("super")&&Object.defineProperty(g,"super",{enumerable:!1,get:function(){var a=m.peek(),b=g;if(a&&a.func){a.trope&&a.trope.isPrivate&&(b=e());if(a.isConstructor){var c=function(){var c=arguments,d,f=[m,e()];for(d=0;d<c.length;d++)f.push(c[d]);a.func.apply(b,f)};c.as=function(a){a instanceof d||typeof a===k&&(a=a.trope?a.trope:new d({constructor:a,prototype:a.prototype,useSuper:!1}));var b=a.createProxyConstructor(!0);return function(){var a,c=[m,e()];for(a=0;a<
arguments.length;a++)c.push(arguments[a]);b.apply(g,c)}};return c}var c=function(){var e;a.trope.inherits?m.push({func:a.trope.inherits.finalProto[a.methodName],trope:a.trope.inherits,isMethod:!0,methodName:a.methodName}):m.push({func:null,trope:null,isMethod:!0,methodName:a.methodName});e=a.func.apply(b,arguments);m.pop();return e},f=a.methodName;c.as=function(a){a instanceof d||typeof a!==k||!a.trope||(a=a.trope);b=a.isPrivate?e():g;return function(){var e;a.inherits?m.push({func:a.inherits.finalProto[f],
trope:a.inherits,isMethod:!0,methodName:f}):m.push({func:null,trope:null,isMethod:!0,methodName:f});e=a.finalProto[f].apply(b,arguments);m.pop();return e}};return c}}});if(a){var p;m=c[0];var q=[];for(p=2;p<c.length;p++)q.push(c[p]);c=q}else m={stack:[],peek:function(){return this.stack[this.stack.length-1]},push:function(a){return this.stack.push(a)},pop:function(){return this.stack.pop()}},b.forEachTropeInChain(function(a){a.forEachMethod(function(b,c){var d;g.hasOwnProperty&&g.hasOwnProperty(c)&&
(d=g[c]);g[c]=function(){var f=arguments;m.push({func:d,trope:a,isMethod:!0,methodName:c});f=a.isPrivate?b.apply(e(),f):b.apply(g,f);m.pop();return f}})});!a&&b.instanceContructor&&v(g,t,b.instanceContructor);m.push({func:b.superConstr,trope:b.inherits,isConstructor:!0});a||b.autoInitializeConfigs.forEach(function(a){var b=a.trope;a.mode===z?g["super"].as(b).apply(null,c):a.mode===x?g["super"].as(b).apply(null,a.args):a.mode===y&&(m.push({func:b.superConstr,trope:b.inherits,isConstructor:!0}),b.isPrivate?
a.initFunc.apply(e(),c):a.initFunc.apply(g,c),m.pop())});b.constr.apply(n,c);m.pop();return g}},getPrototype:function(){return this.inherits?h(this.proto,Object.create(this.inherits.finalProto)):this.proto},getSuperConstructor:function(){return this.useSuper&&this.inherits?this.inherits.getConstructor(!0):null},forEachTropeInChain:function(a){this.inherits&&this.inherits.forEachTropeInChain(a);a(this)},forEachMethod:function(a){s(this.proto,function(b){B(b,a)})},createChildTrope:function(a){a=a||
{};if(a.inherits){var b=this;(function(a){return a?a instanceof d?a:a.trope?a.trope:typeof a===k?new d({constructor:a,prototype:a.prototype,useSuper:!1}):new d({prototype:a,useSuper:!1}):null})(a.inherits).forEachTropeInChain(function(a){b=new d(a.getDefinition({inherits:b}))});a.inherits=b}else a.inherits=this;return new d(a)},defineChild:function(a){return this.createChildTrope(a).getConstructor()},extend:function(){var a=arguments,a=(p[a.length]||p["?"]).apply(p,a);return this.defineChild(a)},
getDefinition:function(a){return a?h(a,h(this.def,{})):h(this.def,{})},isInstance:function(a){var b=this,e=!1;n(a,function(a){a.constructor===b.constr&&(e=!0)});return e}};c.Trope=d;c.define=f;var p={0:function(){},1:function(a){var b=typeof a,e;"object"===b?e=null!==a&&a.__TROPEDEF__?a:{prototype:a}:b===k?e=a.trope?a.trope.getDefinition():{constructor:a}:"string"===b&&(e={type:a});return e},2:function(a,b){var e=typeof a,c=typeof b,e="object"===e&&null!==a?a:e===k?a.trope?a.trope.getDefinition():
{constructor:a}:"string"===e?{type:a}:{};"object"===c?e.prototype=b:c===k?b.trope?e=h(e,b.trope.getDefinition()):e.constructor=b:"string"===c&&(e.type=b);return e},3:function(a,b,e){var c=typeof a,d=typeof b,f=typeof e;a="object"===c&&null!==a?a:c===k?a.trope?a.trope.getDefinition():{constructor:a}:"string"===c?{type:a}:{};"object"===d?a.prototype=b:d===k?b.trope?a=h(a,b.trope.getDefinition()):a.constructor=b:"string"===d&&(a.type=b);"object"===f?a.prototype=e:f===k?e.trope?a=h(a,e.trope.getDefinition()):
a.constructor=e:"string"===f&&(a.type=e);return a},"?":function(){return this["3"].apply(this,arguments)}};c.Define=c;c.instanceOf=function(a,b){if(2!==arguments.length)throw Error("Trope.instanceOf only supports 2 arguments");var c,d;if(typeof a===k&&"object"===typeof b)c=a,d=b;else if("object"===typeof a&&typeof b===k)d=a,c=b;else throw Error("Trope.instanceOf must have an OBJECT and FUNCTION as arguments");return c.trope?c.trope.isInstance(d):d instanceof c};w(c,A,c);return c}();q.exports=u});

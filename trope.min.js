function mix(c,f){if(c===f)return f;var e=Object.keys(c),d,a;for(d=0;d<e.length;d+=1)a=e[d],f[a]=c[a];return f}exports.mix=mix;function forEachPrototypeOf(c,f){var e=Object.getPrototypeOf(c);c&&e&&(f(e),forEachPrototypeOf(e,f))}function forEachProtoInChain(c,f){var e=[c],d;forEachPrototypeOf(c,function(a){e.push(a)});for(d=e.length-1;0<=d;d--)f(e[d])}function forEachMethod(c,f){Object.keys(c).forEach(function(e){"function"===typeof c[e]&&f(c[e],e)})}
function setNonEnumerableProperty(c,f,e){return Object.defineProperty(c,f,{value:e,configurable:!0,enumerable:!1,writable:!0})}function applyAliases(c,f,e){var d;for(d=0;d<f.length;d++)c[f[d]]=e}
var Trope=function(){function c(a){a=a||{prototype:Object.create(null),useSuper:!1};var b=this;b.def=a;b.proto=a.prototype?a.prototype:null===a.prototype?Object.create(null):Object.hasOwnProperty.call(a.constructor,"prototype")?a.constructor.prototype:Object.create(null);b.constr=function(){return a.hasOwnProperty("constructor")?a.constructor:b.proto.hasOwnProperty&&b.proto.hasOwnProperty("constructor")?b.proto.constructor:function(){}}();b.inherits=a.inherits?a.inherits instanceof c?a.inherits:a.inherits.trope?
a.inherits.trope:"function"===typeof a.inherits?new c({constructor:a.inherits,prototype:a.inherits.prototype,useSuper:!1}):new c({prototype:a.inherits,useSuper:!1}):null;b.typeName=a.type?a.type:b.constr!==Object&&b.constr.name?b.constr.name:b.inherits?b.inherits.typeName+"\u2093":"Object\u2093";b.instanceName=a.instance||b.typeName+"\u1d62";if(void 0===a.useInstanceName||a.useInstanceName)b.instanceContructor=eval("(function "+b.instanceName+" () {})");var h;b.inherits&&b.inherits.useSuper?(void 0===
a.useSuper||a.useSuper||console.warn("useSuper {"+b.typeName+"} must be same as parent {"+b.inherits.typeName+"} (defaults to true)!"),h=b.inherits.useSuper):h=void 0!==a.useSuper?a.useSuper:!0;b.useSuper=h;b.isPrivate=void 0!==a.privacy?a.privacy:b.inherits?b.inherits.isPrivate:!1;b.superConstr=b.getSuperConstructor();b.finalProto=b.getPrototype();b.constr!==Object&&setNonEnumerableProperty(b.finalProto,"constructor",b.constr)}var f=function(a){var b=a.length,h,c;for(h=0;h<b;h++)c=a[h],a.push(c.charAt(0).toUpperCase()+
c.substr(1));return a}("class proto alter alt turn extend ext modify mod link chain draft denote outline cast exhibit model compound enhance".split(" "));c.prototype={getConstructor:function(a){var b=this;return function(a){a.prototype=b.finalProto;a.trope=b;a.create=function(){var b=Object.create(a.prototype);a.apply(b,arguments);return b};applyAliases(a,f,b.extend.bind(b));return a}(b.createProxyConstructor(a))},createProxyConstructor:function(a){var b=this;return function(){function h(){if(a)return f[1];
l||(l=Object.create(g),l.exports=g);return l}var d=arguments,f=arguments,g=this,l,n=g;b.isPrivate&&(n=h());var k;b.useSuper&&!a&&g.hasOwnProperty&&!g.hasOwnProperty("super")&&Object.defineProperty(g,"super",{enumerable:!1,get:function(){var a=k.peek(),b=g;if(a){a.trope&&a.trope.isPrivate&&(b=h());if(a.isConstructor){var d=function(){var c=arguments,d,e=[k,h()];for(d=0;d<c.length;d++)e.push(c[d]);a.func.apply(b,e)};d.as=function(a){a instanceof c||typeof a!==e||!a.trope||(a=a.trope);var b=a.createProxyConstructor(!0);
return function(){var a,c=[k,h()];for(a=0;a<arguments.length;a++)c.push(arguments[a]);b.apply(g,c)}};return d}return a.func.bind(b)}}});if(a){var m;k=d[0];var p=[];for(m=2;m<d.length;m++)p.push(d[m]);d=p}else k={stack:[],peek:function(){return this.stack[this.stack.length-1]},push:function(a){return this.stack.push(a)},pop:function(){return this.stack.pop()}},b.forEachTropeInChain(function(a){a.forEachMethod(function(b,c){var d;g.hasOwnProperty&&g.hasOwnProperty(c)?(d=g[c],g[c]=function(){var c=arguments;
k.push({func:d,trope:a,isMethod:!0});c=a.isPrivate?b.apply(h(),c):b.apply(g,c);k.pop();return c}):g[c]=a.isPrivate?b.bind(h()):b.bind(g)})});!a&&b.instanceContructor&&setNonEnumerableProperty(g,"constructor",b.instanceContructor);k.push({func:b.superConstr,trope:b.inherits,isConstructor:!0});b.constr.apply(n,d);k.pop()}},getPrototype:function(){return this.inherits?mix(this.proto,Object.create(this.inherits.finalProto)):this.proto},getSuperConstructor:function(){var a;return this.useSuper&&this.inherits?
a=this.inherits.getConstructor(!0):null},forEachTropeInChain:function(a){this.inherits&&this.inherits.forEachTropeInChain(a);a(this)},forEachMethod:function(a){forEachProtoInChain(this.proto,function(b){forEachMethod(b,a)})},extend:function(){var a=arguments,a=(d[a.length]||d["?"]).apply(d,a);a.inherits=this;return c.define(a)},getDefinition:function(){return mix(this.def,{})}};c.define=function(a){return(new c(a)).getConstructor()};var e="function",d={0:function(){},1:function(a){var b=typeof a,
c;"object"===b?c=null!==a&&a.__TROPEDEF__?a:{prototype:a}:b===e?c=a.trope?a.trope.getDefinition():{constructor:a}:"string"===b&&(c={type:a});return c},2:function(a,b){var c=typeof a,d=typeof b,c="object"===c?a:c===e?a.trope?a.trope.getDefinition():{constructor:a}:"string"===c?{type:a}:{};"object"===d?c.prototype=b:d===e?b.trope?c=mix(c,b.trope.getDefinition()):c.constructor=b:"string"===d&&(c.type=b);return c},3:function(a,b,c){var d=typeof a,f=typeof b,g=typeof c;a="object"===d?a:d===e?a.trope?a.trope.getDefinition():
{constructor:a}:"string"===d?{type:a}:{};"object"===f?a.prototype=b:f===e?b.trope?a=mix(a,b.trope.getDefinition()):a.constructor=b:"string"===f&&(a.type=b);"object"===g?a.prototype=c:g===e?c.trope?a=mix(a,c.trope.getDefinition()):a.constructor=c:"string"===g&&(a.type=c);return a},"?":function(){return this["3"].apply(this,arguments)}};c.Define=function(){var a=arguments,a=(d[a.length]||d["?"]).apply(d,a);return c.define(a)};applyAliases(c,f,c.Define);return c}();module.exports=Trope;
